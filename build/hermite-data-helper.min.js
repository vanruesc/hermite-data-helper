/**
 * hermite-data-helper v0.9.1 build Sat Dec 01 2018
 * https://github.com/vanruesc/hermite-data-helper
 * Copyright 2018 Raoul van RÃ¼schen, Zlib
 */
function _typeof(a){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_typeof(a)}(function(a,b){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=b(require("three")):"function"==typeof define&&define.amd?define(["three"],b):a.HERMITEDATAHELPER=b(a.THREE)})(this,function(a){"use strict";function b(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function c(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function d(a,b,d){return b&&c(a.prototype,b),d&&c(a,d),a}function e(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),b&&g(a,b)}function f(a){return f=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)},f(a)}function g(a,b){return g=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a},g(a,b)}function h(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function i(a,b){return b&&("object"===_typeof(b)||"function"==typeof b)?b:h(a)}var k=0,l=function(c){var h=Math.cbrt;function g(){var c,d=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,h=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,j=!!(3<arguments.length&&void 0!==arguments[3])&&arguments[3],k=!(4<arguments.length&&void 0!==arguments[4])||arguments[4];b(this,g),c=i(this,f(g).call(this)),c.name="HermiteDataHelper",c.cellPosition=d,c.cellSize=e,c.data=h,c.pointsMaterial=new a.PointsMaterial({vertexColors:a.VertexColors,sizeAttenuation:!0,size:.05}),c.add(new a.Group),c.add(new a.Group),c.add(new a.Group),c.gridPoints.name="GridPoints",c.edges.name="Edges",c.normals.name="Normals";try{c.update(j,k)}catch(a){}return c}return e(g,c),d(g,[{key:"validate",value:function(){var a=null;return null===this.cellPosition?a=new Error("The cell position is not defined"):0>=this.cellSize?a=new Error("Invalid cell size: "+this.cellSize):null===this.data?a=new Error("No data"):(this.data.empty&&(a=new Error("The provided data is empty")),this.data.compressed&&(a=new Error("The provided data must be uncompressed"))),a}},{key:"set",value:function(a,b,c){return this.cellPosition=a,this.cellSize=b,this.data=c,this}},{key:"update",value:function(){var a=!!(0<arguments.length&&void 0!==arguments[0])&&arguments[0],b=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],c=this.data,d=this.validate();if(this.dispose(),null!==d)throw d;else a&&this.createPoints(c),b&&null!==c.edgeData&&this.createEdges(c);return this}},{key:"createPoints",value:function(b){var c,d,e,f,g,l=b.materialIndices,m=h(l.length)-1,n=this.cellSize,o=this.cellPosition,p=new a.Vector3,q=new a.Vector3,r=new Float32Array([0,0,0]),s=new a.BufferGeometry,t=b.materials,u=new Float32Array(3*t),v=new Float32Array(3*t);for(f=0,g=0,e=0;e<=m;++e)for(p.z=e*n/m,d=0;d<=m;++d)for(p.y=d*n/m,c=0;c<=m;++c)p.x=c*n/m,l[f++]!==k&&(q.addVectors(o,p),u[g]=q.x,v[g++]=r[0],u[g]=q.y,v[g++]=r[1],u[g]=q.z,v[g++]=r[2]);s.addAttribute("position",new a.BufferAttribute(u,3)),s.addAttribute("color",new a.BufferAttribute(v,3)),this.gridPoints.add(new a.Points(s,this.pointsMaterial))}},{key:"createEdges",value:function(b){var c,e,f,g,k,l,m,o,p,q,r,t,u=b.edgeData,v=h(b.materialIndices.length)-1,n=this.cellSize,s=new a.Vector3,w=new a.Vector3,x=[u.edgesX(this.cellPosition,this.cellSize),u.edgesY(this.cellPosition,this.cellSize),u.edgesZ(this.cellPosition,this.cellSize)],y=[new Float32Array([.6,0,0]),new Float32Array([0,.6,0]),new Float32Array([0,0,.6])],z=new Float32Array([0,1,1]),A=new a.LineBasicMaterial({vertexColors:a.VertexColors});for(r=0,t=0,q=0;3>q;++q,r=0,t=0)if(l=y[q],o=x[q],0<o.lengths.length){k=2*o.lengths[0],c=new Float32Array(3*k),e=new Float32Array(3*k),f=new Float32Array(3*k),g=new Float32Array(3*k);var B=!0,C=!1,D=void 0;try{for(var E,F=o[Symbol.iterator]();!(B=(E=F.next()).done);B=!0)p=E.value,c[r]=p.a.x,e[r++]=l[0],c[r]=p.a.y,e[r++]=l[1],c[r]=p.a.z,e[r++]=l[2],c[r]=p.b.x,e[r++]=l[0],c[r]=p.b.y,e[r++]=l[1],c[r]=p.b.z,e[r++]=l[2],p.computeZeroCrossingPosition(s),w.copy(s).addScaledVector(p.n,.25*n/v),f[t]=s.x,g[t++]=z[0],f[t]=s.y,g[t++]=z[1],f[t]=s.z,g[t++]=z[2],f[t]=w.x,g[t++]=z[0],f[t]=w.y,g[t++]=z[1],f[t]=w.z,g[t++]=z[2]}catch(a){C=!0,D=a}finally{try{B||null==F.return||F.return()}finally{if(C)throw D}}m=new a.BufferGeometry,m.addAttribute("position",new a.BufferAttribute(c,3)),m.addAttribute("color",new a.BufferAttribute(e,3)),this.edges.add(new a.LineSegments(m,A)),m=new a.BufferGeometry,m.addAttribute("position",new a.BufferAttribute(f,3)),m.addAttribute("color",new a.BufferAttribute(g,3)),this.normals.add(new a.LineSegments(m,A))}}},{key:"dispose",value:function(){var a,b,c,d;for(c=0,d=this.children.length;c<d;++c)for(a=this.children[c],b=a.children;0<b.length;)b[0].geometry.dispose(),b[0].material.dispose(),a.remove(b[0])}},{key:"gridPoints",get:function(){return this.children[0]}},{key:"edges",get:function(){return this.children[1]}},{key:"normals",get:function(){return this.children[2]}}],[{key:"air",set:function(a){k=a}}]),g}(a.Group);return l});
