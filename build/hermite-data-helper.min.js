/**
 * hermite-data-helper v1.0.1 build Sat Dec 28 2019
 * https://github.com/vanruesc/hermite-data-helper
 * Copyright 2019 Raoul van RÃ¼schen, Zlib
 */
"use strict";function _typeof(a){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_typeof(a)}(function(a,b){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?b(exports,require("three")):"function"==typeof define&&define.amd?define(["exports","three"],b):(a=a||self,b(a.HERMITEDATAHELPER={},a.THREE))})(void 0,function(a,b){'use strict';function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function d(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function e(a,b,c){return b&&d(a.prototype,b),c&&d(a,c),a}function f(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),b&&h(a,b)}function g(a){return g=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)},g(a)}function h(a,b){return h=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a},h(a,b)}function i(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function j(a,b){return b&&("object"===_typeof(b)||"function"==typeof b)?b:i(a)}var k=0,l=function(a){var h=Math.cbrt;function d(){var a,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,f=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,h=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,i=!!(3<arguments.length&&void 0!==arguments[3])&&arguments[3],k=!(4<arguments.length&&void 0!==arguments[4])||arguments[4];c(this,d),a=j(this,g(d).call(this)),a.name="HermiteDataHelper",a.cellPosition=e,a.cellSize=f,a.data=h,a.pointsMaterial=new b.PointsMaterial({vertexColors:b.VertexColors,sizeAttenuation:!0,size:.05}),a.add(new b.Group),a.add(new b.Group),a.add(new b.Group),a.gridPoints.name="GridPoints",a.edges.name="Edges",a.normals.name="Normals";try{a.update(i,k)}catch(a){}return a}return f(d,a),e(d,[{key:"validate",value:function(){var a=null;return null===this.cellPosition?a=new Error("The cell position is not defined"):0>=this.cellSize?a=new Error("Invalid cell size: "+this.cellSize):null===this.data?a=new Error("No data"):(this.data.empty&&(a=new Error("The provided data is empty")),this.data.compressed&&(a=new Error("The provided data must be uncompressed"))),a}},{key:"set",value:function(a,b,c){return this.cellPosition=a,this.cellSize=b,this.data=c,this}},{key:"update",value:function(){var a=!!(0<arguments.length&&void 0!==arguments[0])&&arguments[0],b=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],c=this.data,d=this.validate();if(this.dispose(),null!==d)throw d;else a&&this.createPoints(c),b&&null!==c.edgeData&&this.createEdges(c);return this}},{key:"createPoints",value:function(a){var c,d,e,f,g,l=a.materialIndices,m=h(l.length)-1,n=this.cellSize,o=this.cellPosition,p=new b.Vector3,q=new b.Vector3,r=new Float32Array([0,0,0]),s=new b.BufferGeometry,t=a.materials,u=new Float32Array(3*t),v=new Float32Array(3*t);for(f=0,g=0,e=0;e<=m;++e)for(p.z=e*n/m,d=0;d<=m;++d)for(p.y=d*n/m,c=0;c<=m;++c)p.x=c*n/m,l[f++]!==k&&(q.addVectors(o,p),u[g]=q.x,v[g++]=r[0],u[g]=q.y,v[g++]=r[1],u[g]=q.z,v[g++]=r[2]);s.setAttribute("position",new b.BufferAttribute(u,3)),s.setAttribute("color",new b.BufferAttribute(v,3)),this.gridPoints.add(new b.Points(s,this.pointsMaterial))}},{key:"createEdges",value:function(a){var c,e,f,g,k,l,m,o,p,q,r,t,u=a.edgeData,v=h(a.materialIndices.length)-1,n=this.cellSize,s=new b.Vector3,w=new b.Vector3,x=[u.edgesX(this.cellPosition,this.cellSize),u.edgesY(this.cellPosition,this.cellSize),u.edgesZ(this.cellPosition,this.cellSize)],y=[new Float32Array([.6,0,0]),new Float32Array([0,.6,0]),new Float32Array([0,0,.6])],z=new Float32Array([0,1,1]),A=new b.LineBasicMaterial({vertexColors:b.VertexColors});for(r=0,t=0,q=0;3>q;++q,r=0,t=0)if(l=y[q],o=x[q],0<o.lengths.length){k=2*o.lengths[0],c=new Float32Array(3*k),e=new Float32Array(3*k),f=new Float32Array(3*k),g=new Float32Array(3*k);var B=!0,C=!1,D=void 0;try{for(var E,F=o[Symbol.iterator]();!(B=(E=F.next()).done);B=!0)p=E.value,c[r]=p.a.x,e[r++]=l[0],c[r]=p.a.y,e[r++]=l[1],c[r]=p.a.z,e[r++]=l[2],c[r]=p.b.x,e[r++]=l[0],c[r]=p.b.y,e[r++]=l[1],c[r]=p.b.z,e[r++]=l[2],p.computeZeroCrossingPosition(s),w.copy(s).addScaledVector(p.n,.25*n/v),f[t]=s.x,g[t++]=z[0],f[t]=s.y,g[t++]=z[1],f[t]=s.z,g[t++]=z[2],f[t]=w.x,g[t++]=z[0],f[t]=w.y,g[t++]=z[1],f[t]=w.z,g[t++]=z[2]}catch(a){C=!0,D=a}finally{try{B||null==F["return"]||F["return"]()}finally{if(C)throw D}}m=new b.BufferGeometry,m.setAttribute("position",new b.BufferAttribute(c,3)),m.setAttribute("color",new b.BufferAttribute(e,3)),this.edges.add(new b.LineSegments(m,A)),m=new b.BufferGeometry,m.setAttribute("position",new b.BufferAttribute(f,3)),m.setAttribute("color",new b.BufferAttribute(g,3)),this.normals.add(new b.LineSegments(m,A))}}},{key:"dispose",value:function(){var a,b,c,d;for(c=0,d=this.children.length;c<d;++c)for(a=this.children[c],b=a.children;0<b.length;)b[0].geometry.dispose(),b[0].material.dispose(),a.remove(b[0])}},{key:"gridPoints",get:function(){return this.children[0]}},{key:"edges",get:function(){return this.children[1]}},{key:"normals",get:function(){return this.children[2]}}],[{key:"air",set:function(a){k=a}}]),d}(b.Group);a.HermiteDataHelper=l,Object.defineProperty(a,"__esModule",{value:!0})});
